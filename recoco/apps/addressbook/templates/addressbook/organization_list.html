{% extends "base.html" %}
{% load guardian_tags %}
{% load static %}
{% block title %}Organisations - Carnet d'adresses {{ block.super }}{% endblock %}
{% block content %}
    {% get_obj_perms request.user for request.site as "user_site_perms" %}
    <div class="col-12 fr-p-2w fr-mx-auto">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
            <ul class="fr-breadcrumb__list">
                <li class="fr-breadcrumb__link">
                    <svg class="bi align-middle" width="18" height="18" fill="currentColor">
                        <use xlink:href="{% static 'svg/bootstrap-icons.svg'  %}#person-lines-fill" />
                    </svg>
                    &nbsp;
                    <a href="{% url 'addressbook-organization-list' %}">Carnet d'adresses</a>
                </li>
                <li class="fr-breadcrumb__link">
                    <span class="text-secondary">Organisations</span>
                </li>
            </ul>
        </nav>
        <div class="w-100">
            <h2 class="mb-3 d-inline-block">
                <svg class="bi" width="28" height="28" fill="currentColor">
                    <use xlink:href="{% static 'svg/bootstrap-icons.svg'  %}#person-lines-fill" />
                </svg>
                Organisations
            </h2>
            {% if "use_addressbook" in user_site_perms %}
                <a class="btn btn-light fr-mb-1v d-inline-block float-end"
                   href="{% url 'addressbook-organization-create' %}">
                    <svg class="bi fr-mr-1v" width="16" height="16" fill="currentColor">
                        <use xlink:href="{% static 'svg/bootstrap-icons.svg'  %}#plus-circle" />
                    </svg>
                    Ajouter
                </a>
            {% endif %}
        </div>
        <table class="table">
            <tr>
                <th>Nom</th>
                <th>Départements</th>
            </tr>
            {% for organization in organizations %}
                <tr>
                    <td>
                        <a class=""
                           href="{% url "addressbook-organization-details" organization.pk %}">{{ organization.name }}</a>
                    </td>
                    <td>
                        {% for department in organization.departments.all %}
                            {{ department.name }} ({{ department.code }})
                            {% if not forloop.last %}/{% endif %}
                        {% empty %}
                            France
                        {% endfor %}
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>
{% endblock %}
