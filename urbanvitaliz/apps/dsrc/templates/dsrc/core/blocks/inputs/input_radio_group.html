{% load widget_tweaks %}
{% load dsrc_tags %}
<fieldset class="fr-fieldset"
          id="radio-hint"
          aria-labelledby="radio-hint-legend radio-hint-messages">
    <legend class="fr-fieldset__legend--regular fr-fieldset__legend"
            id="radio-hint-legend">
        {{ field.label }}
        {% if field.help_text %}<span class="fr-hint-text">{{ field.help_text }}</span>{% endif %}
    </legend>
    {% if field.errors %}
        {% with aria_describedby="aria-describedby:"|add:field.auto_id|add:"-desc-error" %}
            {{ field|attr:"type:radio"|attr:aria_describedby }}
        {% endwith %}
    {% else %}
        {% for choice in field %}
            <div class="fr-fieldset__element">
                <div class="fr-radio-group {% if field.has_errors %}fr-radio-group--error{% endif %}{% if field.is_disabled %} fr-radio-group--disabled{% endif %}{% if field.field.widget.attrs.size %} fr-radio-group--{{ field.field.widget.attrs.size }}{% endif %} {{ field.field.widget.attrs.classes }}">
                    <input name="{{ field.id_for_label }}"
                           id="{{ field.id_for_label }}"
                           type="radio"
                           class="{{ field.field.widget.attrs.classes }}"
                           data-test="{{ field.field.widget.attrs.input_test_id }}-{{ forloop.counter }}"
                           {% if field.errors %}aria-describedby="{{ field.id_for_label }}-desc-error"{% endif %}
                           {% if field.field.required %}required{% endif %}
                           {% if field.field.disabled %}disabled{% endif %} />
                    <label class="fr-label" for="{{ choice.id_for_label }}">{{ choice.choice_label }}</label>
                </div>
            </div>
        {% endfor %}
    {% endif %}
    {% if field.field.messages %}
        {% for message in field.field.messages %}
            <div class="fr-messages-group"
                 id="{{ field.css_id }}-input-messages"
                 aria-live="assertive">
                <p>{{ message }}</p>
            </div>
        {% endfor %}
    {% endif %}
    {% if form.show_errors %}
        <div class="fr-messages-group"
             id="{{ field.css_id }}-desc-error"
             aria-live="polite">
            {% for error in field.errors %}
                <p id="error_{{ forloop.counter }}_{{ field.auto_id }}"
                   class="fr-error-text">{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}
    {% if field.valid_text %}
        <p id="{{ field.css_id }}-desc-valid" class="fr-valid-text">{{ field.valid_text }}</p>
    {% endif %}
</fieldset>
