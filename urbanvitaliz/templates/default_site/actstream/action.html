{% load i18n %}
{% load common_extra %}

<div class="d-block font-marianne">
    <div class="d-flex align-items-start mb-2">
        <img class="align-middle rounded-circle d-inline-block  p-1 {% if not transparent_background %} bg-white {% endif %}"
             width="35px"
             :src='gravatar_url("{{action.actor}}", 25, "{{action.actor.first_name}}" + " " + "{{action.actor.last_name}}")'
             data-bs-toggle="tooltip"
             data-bs-placement="bottom"
             style="z-index: 1000"
             tabindex="0">
        <div class="mt-1 ms-1 font-very-small">
            <span class="text-grey-dark fw-light">
                <strong class="text-dark fw-bold">{{ action.actor.first_name|default:action.actor.email }}
                {{ action.actor.last_name|default:"" }}</strong>
                <i>{{ action.actor.profile.organization_position|default:'' }}</i>
                <span class="d-inline-block">
                <span class="d-inline">
									{% comment %} FIXME	ne pourrait on pas utiliser un template filter ici ?  {% endcomment %}
                    {% if action.verb == verbs.Conversation.PRIVATE_MESSAGE %}
                        a envoyé un nouveau <a class="d-inline text-decoration-none hover-underline text-dark fw-bold" href="{{ action.action_object.get_absolute_url }}">message dans l'espace conseillers</a> sur
                    {% elif action.verb == verbs.Conversation.PUBLIC_MESSAGE %}
                        a envoyé un nouveau <a class="d-inline text-decoration-none hover-underline text-dark fw-bold" href="{{ action.action_object.get_absolute_url }}">message dans l'espace conversation</a> sur
									{% comment %} FIXME	Ajouter les cas manquant du doc google wording {% endcomment %}
                    {% elif action.verb == verbs.Recommendation.CREATED %}
                        a recommandé l'action <a class="d-inline text-decoration-none hover-underline text-dark fw-bold" href="{{ action.action_object.get_absolute_url }}">"{{ action.action_object.intent }}"</a> sur
                    {% elif action.verb == verbs.Survey.UPDATED %}
                        a mis à jour <a class="d-inline text-decoration-none hover-underline text-dark fw-bold" href="{{ action.action_object.get_absolute_url }}"> l'état des lieux </a> sur
                    {% elif action.verb == verbs.Project.INVITAION %}
                        {% if action.action_object.role %}
                            <span>a invité <strong class="d-inline-block fw-bold text-dark">{{action.action_object.email}}</strong> en tant que
                                <strong class="text-dark">
                                    {% if action.action_object.role == "SWITCHTENDER" %}conseiller·e{% else %}collectivité{% endif %}</strong>
                            </span>
                        {% endif %}
                    {% else %}
                        {{action.verb}}
                        {% if action.action_object %}
                            {% if action.action_object.get_absolute_url %}
                                <a class="text-decoration-none hover-underline text-dark fw-bold" href="{{ action.action_object.get_absolute_url }}">{{ action.action_object }}</a>
                            {% else %}
                                {{ action.action_object }}
                            {% endif %}
                        {% endif %}
                    {% endif %}
                </span>


                {% if action.action_object and action.target and action.action_object != action.target %}
                    {% if action.action_object and action.target %}
                        <span class="d-inline"> le projet</span>
                    {% endif %}
                    {% if action.target %}
                        {% if action.target.get_absolute_url %}
                            <a class="text-decoration-none hover-underline text-dark fw-bold"  href="{{ action.target.get_absolute_url }}">{{ action.target }}</a>
                        {% else %}
                            {{ action.target }}
                        {% endif %}
                    {% endif %}
                {% endif %}
                </span>
            </span>
        </div>
    </div>




</div>
